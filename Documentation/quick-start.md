# Quick Start

This document describes how to get started with kernel development in Rust.

## Requirements: Building

This section explains how to fetch the tools needed for building.

To easily check whether the requirements are met, the following target
can be used::

	make LLVM=-17 rustavailable

This triggers the same logic used by Kconfig to determine whether
`RUST_IS_AVAILABLE` should be enabled; but it also explains why not
if that is the case.

### rustc

We always use the latest [rustc](https://rustwiki.org/zh-CN/book/ch01-01-installation.html)

```shell
$ rustc --version
rustc 1.89.0 (29483883e 2025-08-04)
```

### Rust standard library source

The Rust standard library source is required because the build system will
cross-compile ``core``.

If ``rustup`` is being used, run::

```shell
$ rustup component add rust-src
```

The components are installed per toolchain, thus upgrading the Rust compiler
version later on requires re-adding the component.

`RUST_LIB_SRC` needs to be set when using the versioned packages

```shell

$ RUST_LIB_SRC=/usr/src/rustc-$(rustc --version | cut -d' ' -f2)/library
$ echo $RUST_LIB_SRC
/usr/src/rustc-1.89.0/library
```

### libclang

``libclang`` (part of LLVM) is used by ``bindgen`` to understand the C code
in the kernel, which means LLVM needs to be installed; like when the kernel
is compiled with ``LLVM=1``.

Linux distributions are likely to have a suitable one available, so it is
best to check that first.

There are also some binaries for several systems and architectures uploaded at:

	https://releases.llvm.org/download.html

Otherwise, building LLVM takes quite a while, but it is not a complex process:

	https://llvm.org/docs/GettingStarted.html#getting-the-source-code-and-building-llvm

Please see Documentation/kbuild/llvm.rst for more information and further ways
to fetch pre-built releases and distribution packages.

### bindgen

The bindings to the C side of the kernel are generated at build time using
the ``bindgen`` tool.

Install it, for instance, via (note that this will download and build the tool
from source)::

	cargo install --locked bindgen-cli

``bindgen`` uses the ``clang-sys`` crate to find a suitable ``libclang`` (which
may be linked statically, dynamically or loaded at runtime). By default, the
``cargo`` command above will produce a ``bindgen`` binary that will load
``libclang`` at runtime. If it is not found (or a different ``libclang`` than
the one found should be used), the process can be tweaked, e.g. by using the
``LIBCLANG_PATH`` environment variable. For details, please see ``clang-sys``'s
documentation at:

	https://github.com/KyleMayes/clang-sys#linking

	https://github.com/KyleMayes/clang-sys#environment-variables


## Requirements: Developing

This section explains how to fetch the tools needed for developing. That is,
they are not needed when just building the kernel.


### rustfmt

The ``rustfmt`` tool is used to automatically format all the Rust kernel code,
including the generated C bindings (for details, please see
coding-guidelines.rst).

If ``rustup`` is being used, its ``default`` profile already installs the tool,
thus nothing needs to be done. If another profile is being used, the component
can be installed manually::

```shell
$ rustup component add rustfmt
```
The standalone installers also come with ``rustfmt``.


### clippy

``clippy`` is a Rust linter. Running it provides extra warnings for Rust code.
It can be run by passing ``CLIPPY=1`` to ``make`` (for details, please see
general-information.rst).

If ``rustup`` is being used, its ``default`` profile already installs the tool,
thus nothing needs to be done. If another profile is being used, the component
can be installed manually::
```shell
$ rustup component add clippy
```

The standalone installers also come with ``clippy``.


### rustdoc

``rustdoc`` is the documentation tool for Rust. It generates pretty HTML
documentation for Rust code (for details, please see
general-information.rst).

``rustdoc`` is also used to test the examples provided in documented Rust code
(called doctests or documentation tests). The ``rusttest`` Make target uses
this feature.

If ``rustup`` is being used, all the profiles already install the tool,
thus nothing needs to be done.

The standalone installers also come with ``rustdoc``.


### rust-analyzer

The `rust-analyzer <https://rust-analyzer.github.io/>`_ language server can
be used with many editors to enable syntax highlighting, completion, go to
definition, and other features.

``rust-analyzer`` needs a configuration file, ``rust-project.json``, which
can be generated by the ``rust-analyzer`` Make target::

	make LLVM=1 rust-analyzer
